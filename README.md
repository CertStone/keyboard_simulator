跨虚拟机键盘模拟工具 - GUI 图形界面版 (V2)
1. V2 版本重大更新
这个版本针对核心功能和兼容性进行了重大升级，以解决在特定环境下（如 VMware）无法使用的问题，并增加了用户急需的暂停功能。

[核心] 新增两种输入模式:

硬件扫描码模式 (默认): 兼容性极强，可以有效解决在 VMware、VirtualBox、远程桌面和多数游戏中输入无效的问题。它模拟物理键盘的按键动作，是绝大多数场景下的推荐选项。

Unicode 模式: 旧版的实现方式，输入速度快，但在某些软件中可能失效。可作为备用选项。

[新增] 暂停与恢复功能:

全局热键 F11: 在模拟输入过程中，随时按下 F11 可以暂停，再次按下则恢复。

GUI 按钮: 界面上增加了“暂停/恢复”按钮，与热键功能同步。

[优化] 全局热键:

F9: 启动模拟。

F10: 强制停止。

F11: 暂停/恢复。

2. 环境准备与安装
环境要求与上一版相同。如果您是首次使用，请按照以下步骤操作。

第一步：安装 Python
确保您的 Windows 系统已安装 Python 3.x。您可以从 Python 官网 下载。安装时请勾选 "Add Python to PATH"。

第二步：安装所需库
打开 Windows 的命令提示符 (CMD) 或 PowerShell。

依次执行以下两条命令来安装 keyboard 和 tkinterdnd2 库：

pip install keyboard
pip install tkinterdnd2

重要提示: 为了让全局热键生效，强烈建议以管理员身份运行此程序。

3. 使用方法
启动程序:

右键点击 keyboard_simulator_gui.py 文件，选择“以管理员身份运行”。

配置参数:

选择输入模式: 在“通用设置”中，根据您的目标软件环境选择输入模式。如果不确定，请保持默认的“硬件扫描码”模式。

选择操作: 在程序顶部的选项卡选择“文本输入”或“文件传输”。

文本输入模式: 在大的文本框中直接输入或粘贴您想自动键入的内容。

文件传输模式: 将文件拖拽到指定区域，并选择目标虚拟机的操作系统。

设置延迟与倒计时: 根据需要调整。

控制模拟:

开始 (F9): 点击“开始模拟”按钮或按 F9。

暂停/恢复 (F11): 在运行过程中，点击“暂停”按钮或按 F11。按钮文字会在“暂停”和“恢复”间切换。

停止 (F10): 点击“强制停止”按钮或按 F10，可以随时终止任务。

4. 故障排除
输入完全无效怎么办？

首要步骤: 确保“输入模式”设置为 “硬件扫描码 (兼容性强)”。这是解决 VMware 等环境问题的关键。

检查权限: 确认您是以管理员身份运行的程序。

检查焦点: 确认在倒计时结束前，您已将鼠标光标点击到目标虚拟机的窗口内部。

热键不生效怎么办？

这几乎总是因为程序没有以管理员权限运行。关闭程序，然后右键以管理员身份重新运行。

---

跨虚拟机键盘模拟工具 - GUI 图形界面版
1. 功能升级
这个新版本将原有的命令行工具升级为了一个易于使用的图形界面程序，主要包含以下改进：

图形用户界面 (GUI): 无需编辑复杂的 config.json 文件，所有操作都在直观的窗口中完成。

模式切换: 通过选项卡轻松切换“文本输入”和“文件传输”模式。

文件拖放: 在文件传输模式下，直接将文件从您的电脑拖拽到程序窗口即可，无需手动输入路径。

全局热键:

F9: 强制启动模拟输入（等同于点击“开始”按钮）。

F10: 强制停止当前的模拟输入。

实时状态显示: 界面会显示当前程序的状态，如“准备就绪”、“运行中”、“已停止”等。

无阻塞操作: 在模拟输入期间，程序界面不会卡死，您可以随时点击“停止”按钮或使用热键。

2. 环境准备与安装
由于增加了新功能，除了 Python 环境外，还需要安装两个小型的第三方库。

第一步：安装 Python
确保您的 Windows 系统已安装 Python 3.x。您可以从 Python 官网 下载。安装时请勾选 "Add Python to PATH"。

第二步：安装所需库
打开 Windows 的命令提示符 (CMD) 或 PowerShell。

依次执行以下两条命令来安装 keyboard 和 tkinterdnd2 库：

pip install keyboard
pip install tkinterdnd2

重要提示: keyboard 库在监听全局热键时可能需要管理员权限。如果热键不生效，请尝试以管理员身份运行命令提示符，然后再启动程序。

3. 使用方法
启动程序:

在文件所在的目录打开命令提示符。

运行命令: python keyboard_simulator_gui.py

(可选，推荐) 或者，右键点击 keyboard_simulator_gui.py 文件，选择“以管理员身份运行”（如果需要使用热键）。

配置参数:

选择模式: 在程序顶部的选项卡选择“文本输入”或“文件传输”。

文本输入模式:

在大的文本框中直接输入或粘贴您想自动键入的内容。程序会自动处理引号等特殊字符，无需您手动转义。

文件传输模式:

从您的文件管理器中，将文件拖拽到“请将文件拖拽至此”的区域。成功后，标签会显示文件名。

选择目标虚拟机的操作系统 (“Linux” 或 “Windows”)。

通用设置:

按键延迟 (秒): 设置每个按键之间的间隔。如果虚拟机反应慢，可以适当调高此数值。

启动倒计时 (秒): 点击开始后，留出几秒钟时间让您切换到虚拟机的窗口。

开始模拟:

点击界面上的 “开始模拟 (F9)” 按钮，或者直接按下键盘上的 F9 键。

程序状态会变为“运行中”，并开始倒计时。

立刻点击目标虚拟机的窗口，确保输入焦点在虚拟机内。

停止模拟:

如果需要中途停止，可以点击界面上的 “强制停止 (F10)” 按钮，或者随时按下键盘上的 F10 键。

程序会立刻停止输入，状态变为“用户已停止”。

4. 注意事项
管理员权限: 如上所述，为了让全局热键（F9, F10）生效，最好以管理员权限运行此脚本。

键盘布局: 脚本默认基于标准美式 (US) 键盘布局。不同布局可能导致特殊字符映射错误。

焦点问题: 倒计时期间，必须将鼠标焦点切换到目标窗口，否则输入会发送到您当前激活的窗口上。

时间问题：实测74KiB的文件大约需要5分半钟完成输入(延迟0.001)，所以请不要传输过大的文件。

文件名问题：如果文件名中包含特殊字符（如空格、括号等），可能会导致解码失败。建议使用简单的文件名。